{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {
          "type": "grafana",
          "uid": "-- Grafana --"
        },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": null,
  "links": [],
  "panels": [
    {
      "id": 1,
      "type": "gapit-htmlgraphics-panel",
      "title": "Services",
      "transparent": true,
      "gridPos": {
        "h": 24,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "datasource": {
        "type": "grafana-splunk-datasource",
        "uid": "d4c682f8-fd9b-46b2-9b89-e15410aa52dc"
      },
      "targets": [
        {
          "datasource": {
            "type": "grafana-splunk-datasource",
            "uid": "d4c682f8-fd9b-46b2-9b89-e15410aa52dc"
          },
          "query": "| inputlookup bos_services.csv\n| search l3_product=\"$l3_product\"\n| join type=left service_id\n    [| inputlookup bos_signal_status.csv\n     | eval status_value=case(\n         status==\"Green\", 3,\n         status==\"Amber\", 2,\n         status==\"Red\", 1,\n         1=1, null())\n     | stats min(status_value) as min_status count as signal_count by service_id]\n| eval min_status=coalesce(min_status, 3)\n| eval signal_count=coalesce(signal_count, 0)\n| eval health_status=case(\n    min_status==3, \"Green\",\n    min_status==2, \"Amber\",\n    min_status==1, \"Red\",\n    1=1, \"Unknown\")\n| table service_id service_name health_status signal_count\n| sort service_name",
          "refId": "A",
          "rawQuery": true
        }
      ],
      "options": {
        "SVGBaseFix": true,
        "css": "\n:root {\n    --brand-primary: #D71E28;\n    --gray-100: #F3F4F6;\n    --gray-200: #E5E7EB;\n    --gray-500: #6B7280;\n    --gray-700: #374151;\n    --gray-900: #111827;\n    --status-healthy: #10B981;\n    --status-degraded: #F59E0B;\n    --status-critical: #EF4444;\n}\n\n* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\nbody {\n    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n    background-color: var(--gray-100);\n    color: var(--gray-900);\n    line-height: 1.6;\n}\n\n.dashboard-header {\n    background-color: var(--brand-primary);\n    color: white;\n    padding: 0.75rem 2rem;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n    display: flex;\n    justify-content: space-between;\n    align-items: flex-start;\n}\n\n.dashboard-header-left {\n    flex: 1;\n}\n\n.org-path {\n    font-size: 0.875rem;\n    opacity: 0.9;\n}\n\n.dashboard-header h1 {\n    font-size: 1.25rem;\n    font-weight: 700;\n    margin-top: 0.25rem;\n}\n\n.header-right {\n    display: flex;\n    align-items: center;\n    gap: 1.5rem;\n}\n\n.timestamp {\n    font-size: 0.75rem;\n    opacity: 0.9;\n}\n\n.guide-icon {\n    font-size: 1.25rem;\n    cursor: pointer;\n    opacity: 0.9;\n    transition: opacity 0.2s;\n}\n\n.guide-icon:hover {\n    opacity: 1;\n}\n\n.quick-reference {\n    position: fixed;\n    top: 0;\n    right: -500px;\n    width: 480px;\n    height: 100%;\n    background: white;\n    box-shadow: -4px 0 16px rgba(0,0,0,0.2);\n    z-index: 1000;\n    transition: right 0.3s ease;\n    overflow-y: auto;\n}\n\n.quick-reference.visible {\n    right: 0;\n}\n\n.quick-reference .header {\n    position: sticky;\n    top: 0;\n    background: white;\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 1.5rem;\n    border-bottom: 2px solid var(--brand-primary);\n    z-index: 10;\n}\n\n.quick-reference h2 {\n    font-size: 1.25rem;\n    color: var(--gray-900);\n}\n\n.close-btn {\n    cursor: pointer;\n    font-size: 1.5rem;\n    color: var(--gray-500);\n}\n\n.close-btn:hover {\n    color: var(--gray-900);\n}\n\n.quick-reference .content {\n    padding: 1.5rem;\n    color: var(--gray-700);\n    line-height: 1.8;\n}\n\n.quick-reference .content h3 {\n    color: var(--gray-900);\n    font-size: 1rem;\n    margin-top: 1.5rem;\n    margin-bottom: 0.5rem;\n}\n\n.quick-reference .content p {\n    margin-bottom: 1rem;\n}\n\n.quick-reference .content ul {\n    margin-left: 1.5rem;\n    margin-bottom: 1rem;\n}\n\n.guide-overlay {\n    display: none;\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background: rgba(0,0,0,0.3);\n    z-index: 999;\n}\n\n.guide-overlay.visible {\n    display: block;\n}\n\n.container {\n    max-width: 1600px;\n    margin: 0 auto;\n    padding: 2rem;\n}\n\n.services-list {\n    background: white;\n    border-radius: 0.5rem;\n    box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n    overflow: hidden;\n}\n\n.list-header {\n    display: grid;\n    grid-template-columns: 3fr 1fr 2fr 1.5fr;\n    gap: 1rem;\n    padding: 0.75rem 1.5rem;\n    background: var(--gray-100);\n    border-bottom: 2px solid var(--gray-200);\n    font-weight: 600;\n    font-size: 0.75rem;\n    text-transform: uppercase;\n    color: var(--gray-700);\n}\n\n.service-row {\n    display: grid;\n    grid-template-columns: 3fr 1fr 2fr 1.5fr;\n    gap: 1rem;\n    padding: 0.75rem 1.5rem;\n    border-bottom: 1px solid var(--gray-200);\n    cursor: pointer;\n    transition: background 0.2s;\n    align-items: center;\n}\n\n.service-row:hover {\n    background: var(--gray-100);\n}\n\n.service-row:last-child {\n    border-bottom: none;\n}\n\n.service-name-cell {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n}\n\n.status-indicator {\n    width: 4px;\n    height: 40px;\n    border-radius: 2px;\n    flex-shrink: 0;\n}\n\n.status-indicator.healthy { background: var(--status-healthy); }\n.status-indicator.degraded { background: var(--status-degraded); }\n.status-indicator.critical { background: var(--status-critical); }\n\n.service-name {\n    font-weight: 600;\n    color: var(--gray-900);\n}\n\n.status-cell {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.status-dot {\n    width: 12px;\n    height: 12px;\n    border-radius: 50%;\n    flex-shrink: 0;\n}\n\n.status-dot.healthy { background: var(--status-healthy); }\n.status-dot.degraded { background: var(--status-degraded); }\n.status-dot.critical { background: var(--status-critical); }\n\n.status-text {\n    font-size: 0.875rem;\n    font-weight: 500;\n}\n\n.status-text.healthy { color: var(--status-healthy); }\n.status-text.degraded { color: var(--status-degraded); }\n.status-text.critical { color: var(--status-critical); }\n\n.sparkline-cell {\n    display: flex;\n    gap: 2px;\n    height: 24px;\n    align-items: flex-end;\n}\n\n.sparkline-bar {\n    flex: 1;\n    min-width: 3px;\n    height: 24px;\n    border-radius: 1px;\n}\n\n.sparkline-bar.healthy { background: var(--status-healthy); }\n.sparkline-bar.degraded { background: var(--status-degraded); }\n.sparkline-bar.critical { background: var(--status-critical); }\n\n.breakdown-cell {\n    display: flex;\n    gap: 0.5rem;\n    font-size: 0.875rem;\n    flex-wrap: wrap;\n}\n\n.signal-count {\n    padding: 0.25rem 0.5rem;\n    border-radius: 0.25rem;\n    font-size: 0.75rem;\n    font-weight: 600;\n    white-space: nowrap;\n}\n\n.signal-count.critical {\n    background: #FEE2E2;\n    color: #991B1B;\n}\n\n.signal-count.degraded {\n    background: #FEF3C7;\n    color: #92400E;\n}\n\n.signal-count.healthy {\n    background: #D1FAE5;\n    color: #065F46;\n}\n\n.loading, .error {\n    text-align: center;\n    padding: 2rem;\n    color: var(--gray-500);\n}\n\n.footer {\n    max-width: 1600px;\n    margin: 2rem auto 0;\n    padding: 1rem 2rem;\n    text-align: center;\n    font-size: 0.75rem;\n    color: var(--gray-500);\n    border-top: 1px solid var(--gray-200);\n}\n",
        "html": "\n<div class=\"dashboard-header\">\n    <div class=\"dashboard-header-left\">\n        <div class=\"org-path\" id=\"orgPath\">Loading...</div>\n        <h1>Services</h1>\n    </div>\n    <div class=\"header-right\">\n        <div class=\"timestamp\" id=\"timestamp\"></div>\n        <div class=\"guide-icon\" onclick=\"toggleGuide()\">ℹ️</div>\n    </div>\n</div>\n\n<div class=\"container\">\n    <div class=\"services-list\">\n        <div class=\"list-header\">\n            <div>Service Name</div>\n            <div>Status</div>\n            <div>Last 12 Hours</div>\n            <div>Signals</div>\n        </div>\n        <div id=\"tableBody\">\n            <div class=\"loading\">Loading data...</div>\n        </div>\n    </div>\n</div>\n\n<div class=\"footer\">\n    Generated with Business Observability System (BOS) | List Pattern v1 | Data refreshes every 30s\n</div>\n\n<div class=\"guide-overlay\" id=\"overlay\" onclick=\"closeGuide()\"></div>\n<div class=\"quick-reference\" id=\"drawer\">\n    <div class=\"header\">\n        <h2>Dashboard Guide</h2>\n        <span class=\"close-btn\" onclick=\"closeGuide()\">×</span>\n    </div>\n    <div class=\"content\">\n        <h3>Purpose</h3>\n        <p>The Services dashboard shows business health for all services within an L3 product.</p>\n\n        <h3>How to Use</h3>\n        <ul>\n            <li><strong>Visual Scan:</strong> Left border colors provide instant status indication</li>\n            <li><strong>Drill Down:</strong> Click any service to view detailed metrics and SLIs</li>\n            <li><strong>Sparklines:</strong> Show 12-hour trend at hourly intervals</li>\n            <li><strong>Signals:</strong> Count of active monitoring signals for each service</li>\n        </ul>\n\n        <h3>Status Colors</h3>\n        <ul>\n            <li><strong style=\"color: #10B981;\">Green:</strong> All signals healthy</li>\n            <li><strong style=\"color: #F59E0B;\">Amber:</strong> Degraded performance</li>\n            <li><strong style=\"color: #EF4444;\">Red:</strong> Critical issues requiring attention</li>\n        </ul>\n    </div>\n</div>\n\n<script>\nfunction toggleGuide() {\n    var drawer = document.getElementById('drawer');\n    var overlay = document.getElementById('overlay');\n    if (drawer && overlay) {\n        drawer.classList.toggle('visible');\n        overlay.classList.toggle('visible');\n    }\n}\n\nfunction closeGuide() {\n    var drawer = document.getElementById('drawer');\n    var overlay = document.getElementById('overlay');\n    if (drawer && overlay) {\n        drawer.classList.remove('visible');\n        overlay.classList.remove('visible');\n    }\n}\n\n// Update timestamp with simple date string\nif (typeof Date !== 'undefined') {\n    var timestampEl = document.getElementById('timestamp');\n    if (timestampEl) {\n        var d = new Date();\n        timestampEl.textContent = 'Updated: ' + d.toISOString().slice(0, 16).replace('T', ' ');\n    }\n}\n</script>\n",
        "onRender": "\ntry {\n    const tableBody = htmlNode.querySelector('#tableBody');\n    const orgPath = htmlNode.querySelector('#orgPath');\n\n    if (!tableBody) {\n        console.error('tableBody element not found');\n        return;\n    }\n\n    // Set org path from variable\n    if (orgPath) {\n        const l3Product = '$l3_product' || 'Home Lending';\n        orgPath.textContent = l3Product;\n    }\n\n    // Get query data\n    let queryData = null;\n    if (typeof data !== 'undefined' && data && data.series) {\n        queryData = data.series;\n    } else if (typeof htmlGraphics !== 'undefined' && htmlGraphics.data && htmlGraphics.data.series) {\n        queryData = htmlGraphics.data.series;\n    }\n\n    if (!queryData || queryData.length === 0) {\n        tableBody.innerHTML = '<div class=\"error\">No data available</div>';\n        return;\n    }\n\n    const series = queryData[0];\n    const fields = series.fields;\n\n    if (!fields || fields.length === 0) {\n        tableBody.innerHTML = '<div class=\"error\">No fields in data</div>';\n        return;\n    }\n\n    // Build field map\n    const fieldMap = {};\n    fields.forEach((field, index) => {\n        fieldMap[field.name] = index;\n    });\n\n    // Get values arrays\n    const values = fields.map(f => f.values.buffer || f.values || []);\n    const rowCount = values[0] ? values[0].length : 0;\n\n    if (rowCount === 0) {\n        tableBody.innerHTML = '<div class=\"error\">No rows in data</div>';\n        return;\n    }\n\n    // Build table rows\n    let tableHTML = '';\n\n    for (let i = 0; i < rowCount; i++) {\n        const serviceId = values[fieldMap['service_id']] ? values[fieldMap['service_id']][i] : '';\n        const serviceName = values[fieldMap['service_name']] ? values[fieldMap['service_name']][i] : 'Unknown';\n        const signalCount = values[fieldMap['signal_count']] ? values[fieldMap['signal_count']][i] : 0;\n        const healthStatus = values[fieldMap['health_status']] ? values[fieldMap['health_status']][i] : 'Unknown';\n\n        // Determine status class\n        const statusClass = healthStatus === 'Green' ? 'healthy' :\n                           healthStatus === 'Amber' ? 'degraded' :\n                           'critical';\n\n        // Mock sparkline (all green for now - Phase 2: real time series data)\n        let sparklineHTML = '';\n        for (let j = 0; j < 12; j++) {\n            sparklineHTML += `<div class=\"sparkline-bar ${statusClass}\"></div>`;\n        }\n\n        // Mock breakdown counts (Phase 2: real signal counts)\n        const breakdownHTML = '<span class=\"signal-count ' + statusClass + '\">' + signalCount + '</span>';\n\n        tableHTML += `\n            <div class=\"service-row\" onclick=\"window.location.href='/d/bos-exec-svc-detail-splunk/service-detail-splunk-v1?var-service_id=${encodeURIComponent(serviceId)}'\">\n                <div class=\"service-name-cell\">\n                    <div class=\"status-indicator ${statusClass}\"></div>\n                    <div class=\"service-name\">${serviceName}</div>\n                </div>\n                <div class=\"status-cell\">\n                    <div class=\"status-dot ${statusClass}\"></div>\n                    <span class=\"status-text ${statusClass}\">${healthStatus}</span>\n                </div>\n                <div class=\"sparkline-cell\">\n                    ${sparklineHTML}\n                </div>\n                <div class=\"breakdown-cell\">\n                    ${breakdownHTML}\n                </div>\n            </div>\n        `;\n    }\n\n    tableBody.innerHTML = tableHTML;\n\n} catch (err) {\n    console.error('Error processing data:', err);\n    const tableBody = htmlNode.querySelector('#tableBody');\n    if (tableBody) {\n        tableBody.innerHTML = '<div class=\"error\">Error: ' + err.message + '</div>';\n    }\n}\n",
        "renderOnMount": true
      },
      "pluginVersion": "2.2.1"
    }
  ],
  "refresh": "30s",
  "schemaVersion": 39,
  "tags": [
    "executive",
    "services",
    "bos",
    "list-pattern",
    "splunk"
  ],
  "templating": {
    "list": [
      {
        "current": {
          "selected": false,
          "text": "",
          "value": ""
        },
        "hide": 0,
        "name": "l3_product",
        "options": [],
        "query": "",
        "skipUrlSync": false,
        "type": "textbox"
      }
    ]
  },
  "time": {
    "from": "now-2h",
    "to": "now"
  },
  "timepicker": {},
  "timezone": "",
  "title": "Services (List Pattern v1 - Splunk)",
  "uid": "bos-exec-services-splunk",
  "version": 0,
  "weekStart": ""
}